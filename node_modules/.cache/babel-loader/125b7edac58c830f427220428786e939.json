{"ast":null,"code":"// Cullen, Riley\n// YAxisDecorator.js\n// October 8, 2020\nimport { ABarChartDecorator } from \"./ABarChartDecorator\";\nimport Konva from 'konva';\nimport Lodash from 'lodash';\n\nclass YAxisDecorator extends ABarChartDecorator {\n  /**\n   * @summary     This type is a concrete decorator that adds a y-axis to the \n   *              bar chart. \n   * @description This class adds a y-axis line, tick marks, and tick labels\n   *              to the given bar chart (or decorator).\n   * \n   * @requires ABarChartDecorator.js\n   * \n   * @see ABarChartDecorator.js\n   * \n   * @param {BarChart}   chart           This type is a concrete bar chart (or decorator)\n   *                                     that we plan on decorating.\n   * @param {string}     lineColor       The color of the axis and its tick marks\n   * @param {int}        lineStrokeWidth Width of the x-axis\n   * @param {int}        tickStrokeWidth Width of the x-axis ticks\n   * @param {JSON Array} font            Determines font size and font family\n   */\n  constructor({\n    chart,\n    axisLabel = 'hi',\n    lineColor = 'black',\n    lineStrokeWidth = 1,\n    tickStrokeWidth = 0.5,\n    font = {\n      fontSize: 10,\n      fontFamily: 'Times New Roman, Times, serif',\n      textColor: 'black'\n    }\n  }) {\n    super(chart);\n    this._lineColor = lineColor;\n    this._axisLabel = axisLabel;\n    this._lineStrokeWidth = lineStrokeWidth;\n    this._tickStrokeWidth = tickStrokeWidth;\n    this._font = Lodash.cloneDeep(font);\n  }\n  /**\n   * @summary     This function adds an y-axis to give BarChart type.\n   * @description This function calls _chart's CreateBarChart function\n   *              as well as the _CreateYAxis function.\n   */\n\n\n  CreateChart() {\n    this._chart.CreateChart();\n\n    this._CreateYAxis();\n  }\n\n  GetDecoratorSettings() {\n    return {\n      yAxis: {\n        label: this._axisLabel,\n        font: this._font,\n        color: {\n          lineColor: this._lineColor\n        },\n        size: {\n          lineStrokeWidth: this._lineStrokeWidth,\n          tickStrokeWidth: this._tickStrokeWidth\n        }\n      }\n    };\n  }\n  /**\n   * @summary     This function adds a y-axis to the given BarChart type.\n   * @description This function creates a y-axis by calling _CreateAxis\n   *              and _AddTicks.\n   */\n\n\n  _CreateYAxis() {\n    this._CreateAxis();\n\n    var maxWidth = this._AddTicks();\n\n    this._CreateAxisLabel(maxWidth);\n  }\n  /**\n   * @summary     This function adds the base line of the y-axis.\n   * @description This function creates Konva.Line object to represent the\n   *              y-axis and adds it to the given Konva.Group.\n   */\n\n\n  _CreateAxis() {\n    var yAxis = new Konva.Line({\n      points: [0, 0, 0, this._chartHeight],\n      stroke: this._lineColor,\n      strokeWidth: this._lineStrokeWidth\n    });\n    yAxis.rotate(this._rotateBy);\n\n    this._group.add(yAxis);\n  }\n  /**\n   * @summary     This function adds the tick marks and labels to the y-axis.\n   * @description This function iterates through the yScale's range yTick \n   *              times and assigns each of those ticks a numeric value. \n   *              These tick marks and corresponding tick mark values are \n   *              added to the Konva.Group. It should be noted that the \n   *              canvas API does NOT offer a built in function to determine\n   *              the height of text. Thus, we approximate the height of text\n   *              using the width captial 'M'.\n   */\n\n\n  _AddTicks() {\n    var yTicks = this._yScale.ticks(10);\n\n    var helper = new Konva.Group();\n    var tickLength = 6;\n\n    var numberHeight = this._GetFontSize('M', this._font);\n\n    yTicks.forEach(d => {\n      var numberWidth = this._GetFontSize(d, this._font);\n\n      helper.add(new Konva.Line({\n        points: [0, this._yScale(d) - 0.5, -tickLength, this._yScale(d) - 0.5],\n        stroke: this._lineColor,\n        strokeWidth: this._tickStrokeWidth\n      }));\n      var text = new Konva.Text({\n        text: d,\n        fontSize: this._font.fontSize,\n        fontFamily: this._font.fontFamily,\n        x: -tickLength - numberWidth - 5,\n        y: this._yScale(d) - numberHeight / 2,\n        fill: this._font.textColor\n      });\n\n      if (this._rotateBy === 90) {\n        text.setAttr('x', text.getAttr('x') + numberWidth / 2 - numberHeight);\n        text.setAttr('y', text.getAttr('y') + numberHeight - numberWidth / 2);\n        text.rotate(-this._rotateBy);\n      }\n\n      helper.add(text);\n    });\n\n    this._group.add(helper);\n\n    helper.rotate(this._rotateBy);\n    return 2 * numberHeight + this._chartHeight + 5;\n  }\n  /**\n  * @summary Creates the axis label.\n  */\n\n\n  _CreateAxisLabel(maxWidth) {\n    console.log(this._axisLabel);\n    if (this._axisLabel === 'none') return;\n\n    var textWidth = this._GetFontSize(this._axisLabel, this._font),\n        xPos = -maxWidth / 2,\n        yPos = this._chartHeight / 2 - textWidth / 2;\n\n    var textLabel = new Konva.Text({\n      x: xPos,\n      y: yPos,\n      text: this._axisLabel,\n      fontSize: this._font.fontSize,\n      fontFamily: this._font.fontFamily,\n      fill: this._font.textColor\n    });\n    textLabel.rotate(-90);\n\n    this._group.add(textLabel);\n  }\n\n}\n\nexport { YAxisDecorator };","map":{"version":3,"sources":["/Users/mialee/Documents/GitHub/ShareNWWebtool/src/js/Charts/BarChart/Decorators/YAxisDecorator.js"],"names":["ABarChartDecorator","Konva","Lodash","YAxisDecorator","constructor","chart","axisLabel","lineColor","lineStrokeWidth","tickStrokeWidth","font","fontSize","fontFamily","textColor","_lineColor","_axisLabel","_lineStrokeWidth","_tickStrokeWidth","_font","cloneDeep","CreateChart","_chart","_CreateYAxis","GetDecoratorSettings","yAxis","label","color","size","_CreateAxis","maxWidth","_AddTicks","_CreateAxisLabel","Line","points","_chartHeight","stroke","strokeWidth","rotate","_rotateBy","_group","add","yTicks","_yScale","ticks","helper","Group","tickLength","numberHeight","_GetFontSize","forEach","d","numberWidth","text","Text","x","y","fill","setAttr","getAttr","console","log","textWidth","xPos","yPos","textLabel"],"mappings":"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","sourcesContent":["// Cullen, Riley\n// YAxisDecorator.js\n// October 8, 2020\n\nimport { ABarChartDecorator } from \"./ABarChartDecorator\";\nimport Konva from 'konva';\nimport Lodash from 'lodash';\n\nclass YAxisDecorator extends ABarChartDecorator\n{\n    /**\n     * @summary     This type is a concrete decorator that adds a y-axis to the \n     *              bar chart. \n     * @description This class adds a y-axis line, tick marks, and tick labels\n     *              to the given bar chart (or decorator).\n     * \n     * @requires ABarChartDecorator.js\n     * \n     * @see ABarChartDecorator.js\n     * \n     * @param {BarChart}   chart           This type is a concrete bar chart (or decorator)\n     *                                     that we plan on decorating.\n     * @param {string}     lineColor       The color of the axis and its tick marks\n     * @param {int}        lineStrokeWidth Width of the x-axis\n     * @param {int}        tickStrokeWidth Width of the x-axis ticks\n     * @param {JSON Array} font            Determines font size and font family\n     */\n    constructor({chart, axisLabel = 'hi', lineColor = 'black', lineStrokeWidth = 1, tickStrokeWidth = 0.5,\n        font = {fontSize : 10, fontFamily : 'Times New Roman, Times, serif', textColor : 'black'}})\n    {\n        super(chart);\n        this._lineColor = lineColor;\n        this._axisLabel = axisLabel;\n        this._lineStrokeWidth = lineStrokeWidth;\n        this._tickStrokeWidth = tickStrokeWidth;\n        this._font = Lodash.cloneDeep(font);\n    }\n\n    /**\n     * @summary     This function adds an y-axis to give BarChart type.\n     * @description This function calls _chart's CreateBarChart function\n     *              as well as the _CreateYAxis function.\n     */\n    CreateChart()\n    {\n        this._chart.CreateChart();\n        this._CreateYAxis();\n    }\n\n    GetDecoratorSettings()\n    {\n        return {\n            yAxis: {\n                label: this._axisLabel,\n                font: this._font,\n                color: {\n                    lineColor: this._lineColor,\n                },\n                size: {\n                    lineStrokeWidth: this._lineStrokeWidth,\n                    tickStrokeWidth: this._tickStrokeWidth,\n                }\n            }\n        }\n    }\n\n    /**\n     * @summary     This function adds a y-axis to the given BarChart type.\n     * @description This function creates a y-axis by calling _CreateAxis\n     *              and _AddTicks.\n     */\n    _CreateYAxis()\n    {\n        this._CreateAxis();\n        var maxWidth = this._AddTicks();\n        this._CreateAxisLabel(maxWidth);\n    }\n\n    /**\n     * @summary     This function adds the base line of the y-axis.\n     * @description This function creates Konva.Line object to represent the\n     *              y-axis and adds it to the given Konva.Group.\n     */\n    _CreateAxis()\n    {\n        var yAxis = new Konva.Line({\n            points: [0, 0, 0, this._chartHeight],\n            stroke: this._lineColor,\n            strokeWidth: this._lineStrokeWidth,\n        });\n        yAxis.rotate(this._rotateBy);\n        this._group.add(yAxis); \n    }\n\n    /**\n     * @summary     This function adds the tick marks and labels to the y-axis.\n     * @description This function iterates through the yScale's range yTick \n     *              times and assigns each of those ticks a numeric value. \n     *              These tick marks and corresponding tick mark values are \n     *              added to the Konva.Group. It should be noted that the \n     *              canvas API does NOT offer a built in function to determine\n     *              the height of text. Thus, we approximate the height of text\n     *              using the width captial 'M'.\n     */\n    _AddTicks()\n    {\n        var yTicks = this._yScale.ticks(10);\n        var helper = new Konva.Group();\n        var tickLength = 6;\n        var numberHeight = this._GetFontSize('M', this._font); \n        yTicks.forEach(d => {\n            var numberWidth = this._GetFontSize(d, this._font);\n            helper.add(new Konva.Line({\n                points: [0, this._yScale(d) - 0.5, -tickLength, this._yScale(d) - 0.5],\n                stroke: this._lineColor,\n                strokeWidth: this._tickStrokeWidth,\n            }));\n            var text = new Konva.Text({\n                text: d,\n                fontSize: this._font.fontSize,\n                fontFamily: this._font.fontFamily,\n                x: -tickLength - numberWidth - 5,\n                y: this._yScale(d) - (numberHeight / 2),\n                fill: this._font.textColor,\n            }); \n\n            if (this._rotateBy === 90) {\n                text.setAttr('x', text.getAttr('x') + (numberWidth / 2) - (numberHeight));\n                text.setAttr('y', text.getAttr('y') + (numberHeight) - numberWidth / 2);\n                text.rotate(-this._rotateBy)\n            }\n            helper.add(text);\n        });\n        this._group.add(helper);\n        helper.rotate(this._rotateBy);\n        return 2 * numberHeight + this._chartHeight + 5;\n    }\n\n      /**\n     * @summary Creates the axis label.\n     */\n    _CreateAxisLabel(maxWidth)\n    {\n        console.log(this._axisLabel);\n        if (this._axisLabel === 'none') return;\n   \n        var textWidth = this._GetFontSize(this._axisLabel, this._font),\n            xPos = -maxWidth/2,\n            yPos = (this._chartHeight / 2) - (textWidth / 2);\n   \n        var textLabel = new Konva.Text({\n            x: xPos,\n            y: yPos,\n            text: this._axisLabel,\n            fontSize: this._font.fontSize,\n            fontFamily: this._font.fontFamily,\n            fill: this._font.textColor,\n        });\n        textLabel.rotate(-90);\n        this._group.add(textLabel);\n    }\n}\n\nexport { YAxisDecorator };"]},"metadata":{},"sourceType":"module"}